<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#D4785C">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>MyBuilding - ◊™◊ß◊ú◊ï◊™</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,400;9..144,600;9..144,700&family=Rubik:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --color-primary: #D4785C;
            --color-primary-dark: #B8614A;
            --color-primary-light: #E8A18C;
            --color-secondary: #2D5A4A;
            --color-secondary-light: #3D7A64;
            --color-cream: #FFF9F5;
            --color-sand: #F5E6D8;
            --color-sand-dark: #E8D4C4;
            --color-text: #3D2E2A;
            --color-text-muted: #8B7355;
            --color-text-light: #B8A090;
            --color-success: #4A9D7C;
            --color-success-bg: #E8F5F0;
            --color-danger: #C75D5D;
            --color-danger-bg: #FCF0F0;
            --color-warning: #D4A85C;
            --color-warning-bg: #FDF8F0;
            --color-info: #5C8ED4;
            --color-info-bg: #F0F5FC;
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-2xl: 48px;
            --radius-sm: 8px;
            --radius-md: 16px;
            --radius-lg: 24px;
            --radius-xl: 32px;
            --radius-full: 9999px;
            --shadow-sm: 0 2px 8px rgba(61, 46, 42, 0.06);
            --shadow-md: 0 4px 16px rgba(61, 46, 42, 0.08);
            --shadow-lg: 0 8px 32px rgba(61, 46, 42, 0.12);
            --font-display: 'Fraunces', serif;
            --font-body: 'Rubik', sans-serif;
            --safe-top: env(safe-area-inset-top, 0px);
            --safe-bottom: env(safe-area-inset-bottom, 0px);
            --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
            --ease-out-back: cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
        html { font-size: 16px; -webkit-font-smoothing: antialiased; }
        body {
            font-family: var(--font-body);
            background: var(--color-cream);
            color: var(--color-text);
            min-height: 100vh;
            min-height: 100dvh;
            line-height: 1.5;
        }
        [dir="rtl"] { text-align: right; }
        #root { min-height: 100vh; min-height: 100dvh; }

        .app-container {
            max-width: 430px;
            margin: 0 auto;
            background: var(--color-cream);
            min-height: 100vh;
            min-height: 100dvh;
            position: relative;
        }

        /* Header */
        .page-header {
            position: sticky;
            top: 0;
            background: var(--color-cream);
            padding: var(--space-lg);
            padding-top: calc(var(--safe-top) + var(--space-lg));
            z-index: 50;
            border-bottom: 1px solid var(--color-sand);
        }

        .header-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .page-title {
            font-family: var(--font-display);
            font-size: 1.5rem;
            font-weight: 600;
        }

        .header-action {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            background: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow-sm);
            color: var(--color-primary);
            font-size: 1.25rem;
            transition: all 0.3s var(--ease-out-expo);
        }

        .header-action:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: var(--space-sm);
            padding: var(--space-md) var(--space-lg);
            background: var(--color-cream);
        }

        .tab {
            flex: 1;
            padding: var(--space-sm) var(--space-md);
            border: none;
            background: white;
            border-radius: var(--radius-full);
            font-family: var(--font-body);
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--color-text-muted);
            cursor: pointer;
            transition: all 0.3s var(--ease-out-expo);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-xs);
        }

        .tab.active {
            background: var(--color-primary);
            color: white;
        }

        .tab-badge {
            background: var(--color-danger);
            color: white;
            font-size: 0.6875rem;
            padding: 2px 6px;
            border-radius: var(--radius-full);
            font-weight: 600;
        }

        .tab.active .tab-badge {
            background: white;
            color: var(--color-primary);
        }

        /* Main Content */
        .main-content {
            padding: var(--space-md) var(--space-lg);
            padding-bottom: calc(80px + var(--safe-bottom) + var(--space-lg));
        }

        /* Ticket Card */
        .ticket-card {
            background: white;
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-md);
            box-shadow: var(--shadow-sm);
            cursor: pointer;
            transition: all 0.3s var(--ease-out-expo);
            border-right: 4px solid transparent;
        }

        [dir="ltr"] .ticket-card { border-right: none; border-left: 4px solid transparent; }

        .ticket-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .ticket-card.status-open { border-color: var(--color-info); }
        .ticket-card.status-progress { border-color: var(--color-warning); }
        .ticket-card.status-fixed { border-color: var(--color-success); }

        .ticket-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-sm);
        }

        .ticket-category {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .ticket-icon {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.125rem;
        }

        .ticket-icon.water { background: #E3F2FD; }
        .ticket-icon.electric { background: #FFF8E1; }
        .ticket-icon.elevator { background: #F3E5F5; }
        .ticket-icon.cleaning { background: #E8F5E9; }
        .ticket-icon.door { background: #FBE9E7; }
        .ticket-icon.other { background: var(--color-sand); }

        .ticket-cat-name {
            font-weight: 600;
            font-size: 0.9375rem;
        }

        .ticket-status {
            font-size: 0.6875rem;
            font-weight: 600;
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-full);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .ticket-status.open { background: var(--color-info-bg); color: var(--color-info); }
        .ticket-status.progress { background: var(--color-warning-bg); color: var(--color-warning); }
        .ticket-status.fixed { background: var(--color-success-bg); color: var(--color-success); }

        .ticket-description {
            color: var(--color-text-muted);
            font-size: 0.875rem;
            margin-bottom: var(--space-sm);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .ticket-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.75rem;
            color: var(--color-text-light);
        }

        .ticket-apartment {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        .ticket-image-indicator {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: var(--space-2xl);
        }

        .empty-icon {
            font-size: 4rem;
            margin-bottom: var(--space-md);
        }

        .empty-title {
            font-family: var(--font-display);
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: var(--space-sm);
        }

        .empty-text {
            color: var(--color-text-muted);
            font-size: 0.875rem;
        }

        /* Modal Overlay */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(61, 46, 42, 0.5);
            z-index: 100;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: var(--color-cream);
            width: 100%;
            max-width: 430px;
            max-height: 90vh;
            border-radius: var(--radius-xl) var(--radius-xl) 0 0;
            transform: translateY(100%);
            transition: transform 0.4s var(--ease-out-expo);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            padding: var(--space-lg);
            border-bottom: 1px solid var(--color-sand);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-family: var(--font-display);
            font-size: 1.25rem;
            font-weight: 600;
        }

        .modal-close {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-sm);
            background: var(--color-sand);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            color: var(--color-text-muted);
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: var(--color-sand-dark);
        }

        .modal-body {
            padding: var(--space-lg);
            overflow-y: auto;
            flex: 1;
        }

        /* Category Grid */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }

        .category-btn {
            background: white;
            border: 2px solid var(--color-sand-dark);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-sm);
            cursor: pointer;
            transition: all 0.3s var(--ease-out-expo);
        }

        .category-btn:hover {
            border-color: var(--color-primary-light);
        }

        .category-btn.selected {
            border-color: var(--color-primary);
            background: rgba(212, 120, 92, 0.05);
        }

        .category-btn-icon {
            font-size: 1.5rem;
        }

        .category-btn-label {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--color-text);
            text-align: center;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: var(--space-lg);
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--color-text);
            margin-bottom: var(--space-sm);
        }

        .form-input, .form-textarea {
            width: 100%;
            padding: var(--space-md);
            border: 2px solid var(--color-sand-dark);
            border-radius: var(--radius-md);
            font-family: var(--font-body);
            font-size: 1rem;
            color: var(--color-text);
            background: white;
            transition: all 0.3s var(--ease-out-expo);
            outline: none;
        }

        .form-input:focus, .form-textarea:focus {
            border-color: var(--color-primary);
            box-shadow: 0 0 0 4px rgba(212, 120, 92, 0.1);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* Image Upload */
        .image-upload {
            border: 2px dashed var(--color-sand-dark);
            border-radius: var(--radius-md);
            padding: var(--space-xl);
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .image-upload:hover {
            border-color: var(--color-primary-light);
            background: rgba(212, 120, 92, 0.02);
        }

        .image-upload-icon {
            font-size: 2rem;
            margin-bottom: var(--space-sm);
        }

        .image-upload-text {
            font-size: 0.875rem;
            color: var(--color-text-muted);
        }

        .image-upload-hint {
            font-size: 0.75rem;
            color: var(--color-text-light);
            margin-top: var(--space-xs);
        }

        .uploaded-images {
            display: flex;
            gap: var(--space-sm);
            margin-top: var(--space-md);
            flex-wrap: wrap;
        }

        .uploaded-image {
            width: 80px;
            height: 80px;
            border-radius: var(--radius-sm);
            object-fit: cover;
            border: 2px solid var(--color-sand);
        }

        /* Submit Button */
        .btn-submit {
            width: 100%;
            padding: var(--space-md) var(--space-lg);
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-dark) 100%);
            color: white;
            border: none;
            border-radius: var(--radius-md);
            font-family: var(--font-body);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s var(--ease-out-expo);
            box-shadow: var(--shadow-md), 0 4px 20px rgba(212, 120, 92, 0.3);
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg), 0 8px 30px rgba(212, 120, 92, 0.4);
        }

        .btn-submit:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* Ticket Detail Modal */
        .ticket-detail-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }

        .ticket-detail-icon {
            width: 56px;
            height: 56px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .ticket-detail-info h3 {
            font-family: var(--font-display);
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: var(--space-xs);
        }

        .ticket-detail-info span {
            font-size: 0.875rem;
            color: var(--color-text-muted);
        }

        .ticket-timeline {
            margin: var(--space-lg) 0;
            padding-right: var(--space-lg);
            border-right: 2px solid var(--color-sand);
        }

        [dir="ltr"] .ticket-timeline {
            padding-right: 0;
            padding-left: var(--space-lg);
            border-right: none;
            border-left: 2px solid var(--color-sand);
        }

        .timeline-item {
            position: relative;
            padding-bottom: var(--space-lg);
        }

        .timeline-item:last-child {
            padding-bottom: 0;
        }

        .timeline-dot {
            position: absolute;
            right: calc(-1 * var(--space-lg) - 5px);
            top: 0;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--color-sand-dark);
            border: 2px solid var(--color-cream);
        }

        [dir="ltr"] .timeline-dot {
            right: auto;
            left: calc(-1 * var(--space-lg) - 5px);
        }

        .timeline-item.active .timeline-dot {
            background: var(--color-primary);
        }

        .timeline-item.completed .timeline-dot {
            background: var(--color-success);
        }

        .timeline-title {
            font-weight: 600;
            font-size: 0.875rem;
            margin-bottom: var(--space-xs);
        }

        .timeline-date {
            font-size: 0.75rem;
            color: var(--color-text-light);
        }

        .ticket-images {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-sm);
            margin-top: var(--space-lg);
        }

        .ticket-image {
            width: 100%;
            aspect-ratio: 4/3;
            object-fit: cover;
            border-radius: var(--radius-md);
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 430px;
            background: white;
            border-top: 1px solid var(--color-sand);
            padding: var(--space-sm) var(--space-md);
            padding-bottom: calc(var(--safe-bottom) + var(--space-sm));
            display: flex;
            justify-content: space-around;
            z-index: 50;
            box-shadow: 0 -4px 20px rgba(61, 46, 42, 0.06);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: var(--space-xs);
            padding: var(--space-sm) var(--space-md);
            border-radius: var(--radius-md);
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.3s var(--ease-out-expo);
            text-decoration: none;
            position: relative;
        }

        .nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%) scaleX(0);
            width: 24px;
            height: 3px;
            background: var(--color-primary);
            border-radius: var(--radius-full);
            transition: transform 0.3s var(--ease-out-expo);
        }

        .nav-item.active::before { transform: translateX(-50%) scaleX(1); }

        .nav-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            color: var(--color-text-light);
            transition: all 0.3s var(--ease-out-expo);
        }

        .nav-item.active .nav-icon { color: var(--color-primary); }

        .nav-label {
            font-size: 0.6875rem;
            font-weight: 500;
            color: var(--color-text-light);
            transition: color 0.3s ease;
        }

        .nav-item.active .nav-label {
            color: var(--color-primary);
            font-weight: 600;
        }

        .nav-badge {
            position: absolute;
            top: 4px;
            right: 12px;
            width: 8px;
            height: 8px;
            background: var(--color-danger);
            border-radius: 50%;
            border: 2px solid white;
        }

        /* Animations */
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .ticket-card {
            animation: slideUp 0.5s var(--ease-out-expo) forwards;
            opacity: 0;
        }

        .ticket-card:nth-child(1) { animation-delay: 0.05s; }
        .ticket-card:nth-child(2) { animation-delay: 0.1s; }
        .ticket-card:nth-child(3) { animation-delay: 0.15s; }
        .ticket-card:nth-child(4) { animation-delay: 0.2s; }
        .ticket-card:nth-child(5) { animation-delay: 0.25s; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, createContext, useContext } = React;

        // Translations
        const translations = {
            he: {
                title: '◊™◊ß◊ú◊ï◊™',
                tabs: { myTickets: '◊î◊™◊ß◊ú◊ï◊™ ◊©◊ú◊ô', all: '◊õ◊ú ◊î◊ë◊†◊ô◊ô◊ü' },
                status: { open: '◊§◊™◊ï◊ó', progress: '◊ë◊ò◊ô◊§◊ï◊ú', fixed: '◊™◊ï◊ß◊ü' },
                categories: {
                    water: '◊û◊ô◊ù / ◊†◊ñ◊ô◊ú◊î',
                    electric: '◊ó◊©◊û◊ú / ◊™◊ê◊ï◊®◊î',
                    elevator: '◊û◊¢◊ú◊ô◊™',
                    cleaning: '◊†◊ô◊ß◊ô◊ï◊ü',
                    door: '◊ê◊ô◊†◊ò◊®◊ß◊ï◊ù / ◊ì◊ú◊™',
                    other: '◊ê◊ó◊®'
                },
                newTicket: {
                    title: '◊ì◊ô◊ï◊ï◊ó ◊¢◊ú ◊™◊ß◊ú◊î',
                    category: '◊°◊ï◊í ◊î◊™◊ß◊ú◊î',
                    description: '◊™◊ô◊ê◊ï◊® ◊î◊™◊ß◊ú◊î',
                    descPlaceholder: '◊™◊ê◊® ◊ê◊™ ◊î◊™◊ß◊ú◊î ◊ë◊§◊ô◊®◊ï◊ò...',
                    location: '◊û◊ô◊ß◊ï◊ù',
                    locationPlaceholder: '◊ú◊ì◊ï◊í◊û◊î: ◊ú◊ï◊ë◊ô ◊ß◊ï◊û◊î 3',
                    photos: '◊™◊û◊ï◊†◊ï◊™ (◊ê◊ï◊§◊¶◊ô◊ï◊†◊ú◊ô)',
                    photosHint: '◊¢◊ì 3 ◊™◊û◊ï◊†◊ï◊™, ◊û◊ß◊°◊ô◊û◊ï◊ù 5MB ◊õ◊ú ◊ê◊ó◊™',
                    addPhoto: '◊î◊ï◊°◊£ ◊™◊û◊ï◊†◊î',
                    submit: '◊©◊ú◊ó ◊ì◊ô◊ï◊ï◊ó',
                    success: '◊î◊ì◊ô◊ï◊ï◊ó ◊†◊©◊ú◊ó ◊ë◊î◊¶◊ú◊ó◊î!'
                },
                detail: {
                    timeline: '◊î◊ô◊°◊ò◊ï◊®◊ô◊ô◊™ ◊ò◊ô◊§◊ï◊ú',
                    opened: '◊†◊§◊™◊ó◊î ◊™◊ß◊ú◊î',
                    inProgress: '◊î◊™◊ó◊ô◊ú ◊ò◊ô◊§◊ï◊ú',
                    fixed: '◊™◊ï◊ß◊†◊î ◊î◊™◊ß◊ú◊î',
                    photos: '◊™◊û◊ï◊†◊ï◊™ ◊û◊¶◊ï◊®◊§◊ï◊™',
                    reportedBy: '◊ì◊ï◊ï◊ó ◊¢◊ú ◊ô◊ì◊ô ◊ì◊ô◊®◊î'
                },
                empty: {
                    title: '◊ê◊ô◊ü ◊™◊ß◊ú◊ï◊™',
                    text: '◊ú◊ê ◊ì◊ï◊ï◊ó◊ï ◊™◊ß◊ú◊ï◊™ ◊¢◊ì◊ô◊ô◊ü. ◊î◊õ◊ú ◊™◊ß◊ô◊ü!'
                },
                nav: { home: '◊ë◊ô◊™', faults: '◊™◊ß◊ú◊ï◊™', notices: '◊î◊ï◊ì◊¢◊ï◊™', community: '◊ß◊î◊ô◊ú◊î', profile: '◊§◊®◊ï◊§◊ô◊ú' },
                apartment: '◊ì◊ô◊®◊î'
            },
            en: {
                title: 'Issues',
                tabs: { myTickets: 'My Tickets', all: 'All Building' },
                status: { open: 'Open', progress: 'In Progress', fixed: 'Fixed' },
                categories: {
                    water: 'Water / Leak',
                    electric: 'Electric / Lighting',
                    elevator: 'Elevator',
                    cleaning: 'Cleaning',
                    door: 'Intercom / Door',
                    other: 'Other'
                },
                newTicket: {
                    title: 'Report Issue',
                    category: 'Issue Type',
                    description: 'Description',
                    descPlaceholder: 'Describe the issue in detail...',
                    location: 'Location',
                    locationPlaceholder: 'e.g., Lobby Floor 3',
                    photos: 'Photos (optional)',
                    photosHint: 'Up to 3 photos, max 5MB each',
                    addPhoto: 'Add Photo',
                    submit: 'Submit Report',
                    success: 'Report submitted successfully!'
                },
                detail: {
                    timeline: 'Progress History',
                    opened: 'Issue Opened',
                    inProgress: 'Work Started',
                    fixed: 'Issue Fixed',
                    photos: 'Attached Photos',
                    reportedBy: 'Reported by Apt'
                },
                empty: {
                    title: 'No Issues',
                    text: 'No issues reported yet. All good!'
                },
                nav: { home: 'Home', faults: 'Issues', notices: 'Notices', community: 'Community', profile: 'Profile' },
                apartment: 'Apt'
            }
        };

        // Language Context
        const LanguageContext = createContext();
        const LanguageProvider = ({ children }) => {
            const [lang, setLang] = useState('he');
            const t = translations[lang];
            const isRTL = lang === 'he';
            useEffect(() => {
                document.documentElement.lang = lang;
                document.documentElement.dir = isRTL ? 'rtl' : 'ltr';
            }, [lang, isRTL]);
            return (
                <LanguageContext.Provider value={{ lang, t, isRTL, toggleLanguage: () => setLang(l => l === 'he' ? 'en' : 'he') }}>
                    {children}
                </LanguageContext.Provider>
            );
        };
        const useLanguage = () => useContext(LanguageContext);

        // Mock Data
        const mockTickets = [
            {
                id: 1,
                category: 'water',
                description: '◊ô◊© ◊†◊ñ◊ô◊ú◊î ◊ë◊™◊ß◊®◊î ◊©◊ú ◊î◊ú◊ï◊ë◊ô ◊ë◊ß◊ï◊û◊î 2. ◊î◊û◊ô◊ù ◊û◊ò◊§◊ò◊§◊ô◊ù ◊ú◊ô◊ì ◊î◊û◊¢◊ú◊ô◊™.',
                descriptionEn: 'There is a leak in the ceiling of the lobby on floor 2. Water is dripping near the elevator.',
                location: '◊ú◊ï◊ë◊ô ◊ß◊ï◊û◊î 2',
                locationEn: 'Lobby Floor 2',
                status: 'progress',
                apartment: '7',
                date: '2025-02-03',
                hasImages: true,
                timeline: [
                    { status: 'opened', date: '2025-02-03 09:30' },
                    { status: 'progress', date: '2025-02-03 14:00' }
                ]
            },
            {
                id: 2,
                category: 'electric',
                description: '◊†◊ï◊®◊î ◊©◊®◊ï◊§◊î ◊ë◊ó◊ì◊® ◊î◊û◊ì◊®◊í◊ï◊™ ◊ë◊ô◊ü ◊ß◊ï◊û◊î 4 ◊ú-5',
                descriptionEn: 'Burnt bulb in the stairwell between floors 4 and 5',
                location: '◊ó◊ì◊® ◊û◊ì◊®◊í◊ï◊™ ◊ß◊ï◊û◊î 4-5',
                locationEn: 'Stairwell Floor 4-5',
                status: 'open',
                apartment: '12',
                date: '2025-02-02',
                hasImages: false,
                timeline: [
                    { status: 'opened', date: '2025-02-02 18:45' }
                ]
            },
            {
                id: 3,
                category: 'elevator',
                description: '◊î◊û◊¢◊ú◊ô◊™ ◊¢◊ï◊©◊î ◊®◊¢◊© ◊ó◊®◊ô◊í ◊ë◊¢◊™ ◊†◊°◊ô◊¢◊î',
                descriptionEn: 'The elevator makes unusual noise while moving',
                location: '◊û◊¢◊ú◊ô◊™ ◊®◊ê◊©◊ô◊™',
                locationEn: 'Main Elevator',
                status: 'fixed',
                apartment: '3',
                date: '2025-01-28',
                hasImages: true,
                timeline: [
                    { status: 'opened', date: '2025-01-28 10:00' },
                    { status: 'progress', date: '2025-01-29 09:00' },
                    { status: 'fixed', date: '2025-01-30 16:00' }
                ]
            },
            {
                id: 4,
                category: 'cleaning',
                description: '◊î◊®◊¶◊§◊î ◊ë◊ú◊ï◊ë◊ô ◊î◊õ◊†◊ô◊°◊î ◊û◊ú◊ï◊õ◊ú◊õ◊™ ◊ï◊ì◊ï◊®◊©◊™ ◊©◊ò◊ô◊§◊î',
                descriptionEn: 'The floor in the entrance lobby is dirty and needs washing',
                location: '◊ú◊ï◊ë◊ô ◊õ◊†◊ô◊°◊î',
                locationEn: 'Entrance Lobby',
                status: 'fixed',
                apartment: '5',
                date: '2025-01-25',
                hasImages: false,
                timeline: [
                    { status: 'opened', date: '2025-01-25 08:00' },
                    { status: 'fixed', date: '2025-01-25 14:00' }
                ]
            }
        ];

        const categoryIcons = {
            water: { icon: 'üíß', bg: 'water' },
            electric: { icon: 'üí°', bg: 'electric' },
            elevator: { icon: 'üõó', bg: 'elevator' },
            cleaning: { icon: 'üßπ', bg: 'cleaning' },
            door: { icon: 'üö™', bg: 'door' },
            other: { icon: 'üìã', bg: 'other' }
        };

        // Components
        const TicketCard = ({ ticket, onClick }) => {
            const { t, lang } = useLanguage();
            const cat = categoryIcons[ticket.category];
            const description = lang === 'he' ? ticket.description : ticket.descriptionEn;

            return (
                <div className={`ticket-card status-${ticket.status}`} onClick={onClick}>
                    <div className="ticket-header">
                        <div className="ticket-category">
                            <div className={`ticket-icon ${cat.bg}`}>{cat.icon}</div>
                            <span className="ticket-cat-name">{t.categories[ticket.category]}</span>
                        </div>
                        <span className={`ticket-status ${ticket.status}`}>
                            {t.status[ticket.status === 'progress' ? 'progress' : ticket.status]}
                        </span>
                    </div>
                    <p className="ticket-description">{description}</p>
                    <div className="ticket-meta">
                        <span className="ticket-apartment">
                            {t.apartment} {ticket.apartment} ‚Ä¢ {ticket.date}
                        </span>
                        {ticket.hasImages && (
                            <span className="ticket-image-indicator">üì∑ 2</span>
                        )}
                    </div>
                </div>
            );
        };

        const NewTicketModal = ({ isOpen, onClose, onSubmit }) => {
            const { t } = useLanguage();
            const [category, setCategory] = useState('');
            const [description, setDescription] = useState('');
            const [location, setLocation] = useState('');
            const [photos, setPhotos] = useState([]);
            const fileInputRef = React.useRef(null);

            const handleFileChange = (e) => {
                const files = Array.from(e.target.files);
                const validFiles = files.filter(file => {
                    if (!file.type.startsWith('image/')) return false;
                    if (file.size > 5 * 1024 * 1024) return false; // 5MB limit
                    return true;
                }).slice(0, 3 - photos.length); // Max 3 photos

                validFiles.forEach(file => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        setPhotos(prev => [...prev, { file, preview: e.target.result }].slice(0, 3));
                    };
                    reader.readAsDataURL(file);
                });
            };

            const removePhoto = (index) => {
                setPhotos(prev => prev.filter((_, i) => i !== index));
            };

            const handleSubmit = () => {
                if (category && description) {
                    onSubmit({ category, description, location, photos });
                    setCategory('');
                    setDescription('');
                    setLocation('');
                    setPhotos([]);
                    onClose();
                }
            };

            return (
                <div className={`modal-overlay ${isOpen ? 'active' : ''}`} onClick={onClose}>
                    <div className="modal-content" onClick={e => e.stopPropagation()}>
                        <div className="modal-header">
                            <h2 className="modal-title">{t.newTicket.title}</h2>
                            <button className="modal-close" onClick={onClose}>‚úï</button>
                        </div>
                        <div className="modal-body">
                            <div className="form-group">
                                <label className="form-label">{t.newTicket.category}</label>
                                <div className="category-grid">
                                    {Object.entries(categoryIcons).map(([key, val]) => (
                                        <button
                                            key={key}
                                            className={`category-btn ${category === key ? 'selected' : ''}`}
                                            onClick={() => setCategory(key)}
                                        >
                                            <span className="category-btn-icon">{val.icon}</span>
                                            <span className="category-btn-label">{t.categories[key]}</span>
                                        </button>
                                    ))}
                                </div>
                            </div>

                            <div className="form-group">
                                <label className="form-label">{t.newTicket.description}</label>
                                <textarea
                                    className="form-textarea"
                                    placeholder={t.newTicket.descPlaceholder}
                                    value={description}
                                    onChange={e => setDescription(e.target.value)}
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">{t.newTicket.location}</label>
                                <input
                                    type="text"
                                    className="form-input"
                                    placeholder={t.newTicket.locationPlaceholder}
                                    value={location}
                                    onChange={e => setLocation(e.target.value)}
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">{t.newTicket.photos}</label>
                                <input
                                    type="file"
                                    ref={fileInputRef}
                                    accept="image/*"
                                    multiple
                                    onChange={handleFileChange}
                                    style={{ display: 'none' }}
                                />
                                {photos.length > 0 && (
                                    <div style={{ display: 'flex', gap: 'var(--space-sm)', marginBottom: 'var(--space-sm)', flexWrap: 'wrap' }}>
                                        {photos.map((photo, index) => (
                                            <div key={index} style={{ position: 'relative' }}>
                                                <img
                                                    src={photo.preview}
                                                    alt=""
                                                    style={{ width: '80px', height: '80px', objectFit: 'cover', borderRadius: 'var(--radius-sm)' }}
                                                />
                                                <button
                                                    onClick={() => removePhoto(index)}
                                                    style={{
                                                        position: 'absolute',
                                                        top: '-8px',
                                                        right: '-8px',
                                                        width: '24px',
                                                        height: '24px',
                                                        borderRadius: '50%',
                                                        background: 'var(--color-danger)',
                                                        color: 'white',
                                                        border: 'none',
                                                        cursor: 'pointer',
                                                        fontSize: '12px'
                                                    }}
                                                >‚úï</button>
                                            </div>
                                        ))}
                                    </div>
                                )}
                                {photos.length < 3 && (
                                    <div
                                        className="image-upload"
                                        onClick={() => fileInputRef.current?.click()}
                                        style={{ cursor: 'pointer' }}
                                    >
                                        <div className="image-upload-icon">üì∑</div>
                                        <div className="image-upload-text">{t.newTicket.addPhoto}</div>
                                        <div className="image-upload-hint">{t.newTicket.photosHint}</div>
                                    </div>
                                )}
                            </div>

                            <button
                                className="btn-submit"
                                onClick={handleSubmit}
                                disabled={!category || !description}
                            >
                                {t.newTicket.submit}
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const TicketDetailModal = ({ ticket, isOpen, onClose }) => {
            const { t, lang } = useLanguage();
            if (!ticket) return null;

            const cat = categoryIcons[ticket.category];
            const description = lang === 'he' ? ticket.description : ticket.descriptionEn;
            const location = lang === 'he' ? ticket.location : ticket.locationEn;

            const getTimelineLabel = (status) => {
                if (status === 'opened') return t.detail.opened;
                if (status === 'progress') return t.detail.inProgress;
                if (status === 'fixed') return t.detail.fixed;
                return status;
            };

            return (
                <div className={`modal-overlay ${isOpen ? 'active' : ''}`} onClick={onClose}>
                    <div className="modal-content" onClick={e => e.stopPropagation()}>
                        <div className="modal-header">
                            <span className={`ticket-status ${ticket.status}`}>
                                {t.status[ticket.status === 'progress' ? 'progress' : ticket.status]}
                            </span>
                            <button className="modal-close" onClick={onClose}>‚úï</button>
                        </div>
                        <div className="modal-body">
                            <div className="ticket-detail-header">
                                <div className={`ticket-detail-icon ticket-icon ${cat.bg}`}>
                                    {cat.icon}
                                </div>
                                <div className="ticket-detail-info">
                                    <h3>{t.categories[ticket.category]}</h3>
                                    <span>{location}</span>
                                </div>
                            </div>

                            <p style={{ marginBottom: 'var(--space-lg)', color: 'var(--color-text)' }}>
                                {description}
                            </p>

                            <p style={{ fontSize: '0.875rem', color: 'var(--color-text-muted)', marginBottom: 'var(--space-lg)' }}>
                                {t.detail.reportedBy} {ticket.apartment}
                            </p>

                            <h4 style={{ fontFamily: 'var(--font-display)', marginBottom: 'var(--space-md)' }}>
                                {t.detail.timeline}
                            </h4>
                            <div className="ticket-timeline">
                                {ticket.timeline.map((item, i) => (
                                    <div
                                        key={i}
                                        className={`timeline-item ${i === ticket.timeline.length - 1 ? 'active' : 'completed'}`}
                                    >
                                        <div className="timeline-dot"></div>
                                        <div className="timeline-title">{getTimelineLabel(item.status)}</div>
                                        <div className="timeline-date">{item.date}</div>
                                    </div>
                                ))}
                            </div>

                            {ticket.hasImages && (
                                <>
                                    <h4 style={{ fontFamily: 'var(--font-display)', marginBottom: 'var(--space-md)', marginTop: 'var(--space-lg)' }}>
                                        {t.detail.photos}
                                    </h4>
                                    <div className="ticket-images">
                                        <img className="ticket-image" src="https://picsum.photos/200/150?random=1" alt="" />
                                        <img className="ticket-image" src="https://picsum.photos/200/150?random=2" alt="" />
                                    </div>
                                </>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const BottomNav = () => {
            const { t } = useLanguage();
            const navItems = [
                { id: 'home', icon: 'üè†', label: t.nav.home, href: 'index.html' },
                { id: 'faults', icon: 'üîß', label: t.nav.faults, href: 'faults.html', active: true },
                { id: 'notices', icon: 'üîî', label: t.nav.notices, href: 'notices.html', badge: true },
                { id: 'community', icon: 'üë•', label: t.nav.community, href: 'community.html' },
                { id: 'profile', icon: 'üë§', label: t.nav.profile, href: 'profile.html' }
            ];

            return (
                <nav className="bottom-nav">
                    {navItems.map(item => (
                        <a
                            key={item.id}
                            href={item.href}
                            className={`nav-item ${item.active ? 'active' : ''}`}
                        >
                            <span className="nav-icon">{item.icon}</span>
                            <span className="nav-label">{item.label}</span>
                            {item.badge && !item.active && <span className="nav-badge" />}
                        </a>
                    ))}
                </nav>
            );
        };

        const App = () => {
            const { t, lang, toggleLanguage } = useLanguage();
            const [activeTab, setActiveTab] = useState('all');
            const [showNewModal, setShowNewModal] = useState(false);
            const [selectedTicket, setSelectedTicket] = useState(null);
            const [tickets, setTickets] = useState(mockTickets);

            const filteredTickets = activeTab === 'myTickets'
                ? tickets.filter(t => t.apartment === '12')
                : tickets;

            const openCount = tickets.filter(t => t.status === 'open').length;

            const handleNewTicket = (data) => {
                const newTicket = {
                    id: tickets.length + 1,
                    ...data,
                    status: 'open',
                    apartment: '12',
                    date: new Date().toISOString().split('T')[0],
                    hasImages: false,
                    timeline: [{ status: 'opened', date: new Date().toLocaleString('he-IL') }]
                };
                setTickets([newTicket, ...tickets]);
            };

            return (
                <div className="app-container">
                    <header className="page-header">
                        <div className="header-row">
                            <h1 className="page-title">{t.title}</h1>
                            <button className="header-action" onClick={() => setShowNewModal(true)}>
                                ‚ûï
                            </button>
                        </div>
                    </header>

                    <div className="tabs">
                        <button
                            className={`tab ${activeTab === 'all' ? 'active' : ''}`}
                            onClick={() => setActiveTab('all')}
                        >
                            {t.tabs.all}
                            {openCount > 0 && <span className="tab-badge">{openCount}</span>}
                        </button>
                        <button
                            className={`tab ${activeTab === 'myTickets' ? 'active' : ''}`}
                            onClick={() => setActiveTab('myTickets')}
                        >
                            {t.tabs.myTickets}
                        </button>
                    </div>

                    <main className="main-content">
                        {filteredTickets.length === 0 ? (
                            <div className="empty-state">
                                <div className="empty-icon">‚úÖ</div>
                                <h3 className="empty-title">{t.empty.title}</h3>
                                <p className="empty-text">{t.empty.text}</p>
                            </div>
                        ) : (
                            filteredTickets.map(ticket => (
                                <TicketCard
                                    key={ticket.id}
                                    ticket={ticket}
                                    onClick={() => setSelectedTicket(ticket)}
                                />
                            ))
                        )}
                    </main>

                    <BottomNav />

                    <NewTicketModal
                        isOpen={showNewModal}
                        onClose={() => setShowNewModal(false)}
                        onSubmit={handleNewTicket}
                    />

                    <TicketDetailModal
                        ticket={selectedTicket}
                        isOpen={!!selectedTicket}
                        onClose={() => setSelectedTicket(null)}
                    />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(
            <LanguageProvider>
                <App />
            </LanguageProvider>
        );
    </script>
</body>
</html>
